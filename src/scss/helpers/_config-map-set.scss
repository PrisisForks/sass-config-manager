// Sets a value to a Map by the map path
//
// @function config-map-set
//
// @access private
//
// @param $map   {map}    The Map
// @param $path  {string} The map path
// @param $value {*|null} The value to set
//
// @return       {map...} A new Map
@function config-map-set($map, $path, $value) {
  $keys: str-split($path, $config-delimiter);
  $length: length($keys);

  $result: (nth($keys, $length): $value);

  @for $i from 1 through $length - 1 {
    $path: '';
    $key: nth($keys, 1);

    @if $length > 1 {
      $j: $length - $i;
      $key: nth($keys, $j);

      $path: str-join(list-slice($keys, 1, $j), $config-delimiter);
    }

    @if config-map-has($map, $path) {
      $value: config-map-get($map, $path);

      @if type-of($value) == 'map' {
        $result: config-map-merge(($key: $value), ($key: $result));
      } @else {
        $result: ($key: $result);
      }
    } @else {
      $result: ($key: $result);
    }
  }

  $map: config-map-merge($map, $result);

  @return $map;
}
